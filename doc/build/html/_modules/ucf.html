

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ucf &mdash; Uncertainty Estimate with SVM 0.0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Uncertainty Estimate with SVM 0.0.1 documentation" href="../index.html"/>
        <link rel="up" title="Module code" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Uncertainty Estimate with SVM
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.compute_predictive_entropy.html">compute_predictive_entropy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.generate_ensemble.html">generate_ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.generate_predictions.html">generate_predictions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.get_all_files_within_folder.html">get_all_files_within_folder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.get_all_sub_folders_within_folder.html">get_all_sub_folders_within_folder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.get_data.html">get_data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.make_confusion_matrix.html">make_confusion_matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.plot_comparison.html">plot_comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.plot_confusion_matrix.html">plot_confusion_matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.plot_individual_classes.html">plot_individual_classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.plot_solution.html">plot_solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.reduce_set_to_equal_distribution_of_classes.html">reduce_set_to_equal_distribution_of_classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.scatter_plot_with_groups.html">scatter_plot_with_groups</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/ucf.TrainingDataSets.html">TrainingDataSets</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Uncertainty Estimate with SVM</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>ucf</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for ucf</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">product</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">grid_spec</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="k">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="k">import</span> <span class="n">SVC</span>


<div class="viewcode-block" id="get_all_files_within_folder"><a class="viewcode-back" href="../api/ucf.get_all_files_within_folder.html#ucf.get_all_files_within_folder">[docs]</a><span class="k">def</span> <span class="nf">get_all_files_within_folder</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">negative_condition</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Catalogue all files within a folder according to negative condition</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        Path to the folder.</span>
<span class="sd">    negative_condition : str</span>
<span class="sd">        Exact text contained with the name of the files, which is</span>
<span class="sd">        utilized to identify files which will not be catalogued.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        Names of all files within folder except file names designated in</span>
<span class="sd">        `negative_condition` parameter.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">negative_condition</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">]</span></div>


<div class="viewcode-block" id="get_all_sub_folders_within_folder"><a class="viewcode-back" href="../api/ucf.get_all_sub_folders_within_folder.html#ucf.get_all_sub_folders_within_folder">[docs]</a><span class="k">def</span> <span class="nf">get_all_sub_folders_within_folder</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Catalogue names of all sub-folders within folder</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        Path to the main folder.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        Names of all sub-folder within folder designated in `path` parameter.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
    <span class="p">]</span></div>


<div class="viewcode-block" id="get_data"><a class="viewcode-back" href="../api/ucf.get_data.html#ucf.get_data">[docs]</a><span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="n">folder_wh_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build an inventory of data sets out of individual files within a</span>
<span class="sd">    folder.</span>

<span class="sd">    Function omits files which are having `txt` inside their name.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    folder_wh_data : str</span>
<span class="sd">        Folder in which data files are residing.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        All the data sets generated from individual data</span>
<span class="sd">        files.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make inventory of sub folder names.</span>
    <span class="n">inventory_of_sub_folders</span> <span class="o">=</span> <span class="n">get_all_sub_folders_within_folder</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="n">folder_wh_data</span>
    <span class="p">)</span>
    <span class="c1"># Declare an empty list to store data files.</span>
    <span class="n">inventory_of_data_sets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Iterate over sub folder, and then iterate over files within sub-folders,</span>
    <span class="c1"># get files, assign correct index, and append to the inventory.</span>
    <span class="k">for</span> <span class="n">sub_folder</span> <span class="ow">in</span> <span class="n">inventory_of_sub_folders</span><span class="p">:</span>
        <span class="c1"># Make inventory of data file names.</span>
        <span class="n">inventory_of_data_files</span> <span class="o">=</span> <span class="n">get_all_files_within_folder</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_wh_data</span><span class="p">,</span> <span class="n">sub_folder</span><span class="p">),</span>
            <span class="n">negative_condition</span><span class="o">=</span><span class="s1">&#39;txt&#39;</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">data_file_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inventory_of_data_files</span><span class="p">):</span>
            <span class="c1"># Get data.</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Getting data from file: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">data_file_name</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">inventory_of_data_sets</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
                    <span class="n">filepath_or_buffer</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="n">folder_wh_data</span><span class="p">,</span>
                        <span class="n">sub_folder</span><span class="p">,</span>
                        <span class="n">data_file_name</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="p">),</span>
                    <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span>
                <span class="p">)</span>
            <span class="p">])</span>
    <span class="k">return</span> <span class="n">inventory_of_data_sets</span></div>


<div class="viewcode-block" id="TrainingDataSets"><a class="viewcode-back" href="../api/ucf.TrainingDataSets.html#ucf.TrainingDataSets">[docs]</a><span class="k">class</span> <span class="nc">TrainingDataSets</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for generating training, validation, and testing data sets.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    original_data : pandas.DataFrame</span>
<span class="sd">        Original features and targets.</span>
<span class="sd">    indices_of_features : list</span>
<span class="sd">        Numeric indication of position of features in `original_data`</span>
<span class="sd">    indices_of_targets : list</span>
<span class="sd">        Numeric indication of position of targets in `original_data`</span>
<span class="sd">    train_features : numpy.array</span>
<span class="sd">        Unscaled training features.</span>
<span class="sd">    train_targets : numpy.array</span>
<span class="sd">        Training targets. Shuffled if desired.</span>
<span class="sd">    validation_features : numpy.array</span>
<span class="sd">        Validation features</span>
<span class="sd">    validation_targets : numpy.array</span>
<span class="sd">        Validation Targets</span>
<span class="sd">    test_features : numpy.array</span>
<span class="sd">        Testing features</span>
<span class="sd">    test_targets : numpy.array</span>
<span class="sd">        Testing targets</span>
<span class="sd">    scaled_train_features : numpy.array</span>
<span class="sd">        Train features scaled to mean zero and unit variance. Shuffled</span>
<span class="sd">        if desired.</span>
<span class="sd">    scaled_validation_features : Numpy Array</span>
<span class="sd">        Validation features scaled to mean zero and unit variance.</span>
<span class="sd">    scaled_test_features : Numpy Array</span>
<span class="sd">        Test features scaled to mean zero and unit variance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features_and_targets_data_set</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_data</span> <span class="o">=</span> <span class="n">features_and_targets_data_set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indices_of_features</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indices_of_targets</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_features</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_targets</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validation_features</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validation_targets</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_features</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_targets</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features_mean</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features_standard_deviation</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_train_features</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_validation_features</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_test_features</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="TrainingDataSets.shuffle"><a class="viewcode-back" href="../api/ucf.TrainingDataSets.html#ucf.TrainingDataSets.shuffle">[docs]</a>    <span class="k">def</span> <span class="nf">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shuffle scaled features and unscaled targets for training</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Only scaled training features and targets are shuffled. Validation,</span>
<span class="sd">        and test data sets are not shuffled.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">shuffled_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_train_features</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_train_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaled_train_features</span><span class="p">[</span>
            <span class="n">shuffled_order</span><span class="p">,</span> <span class="p">:</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_targets</span><span class="p">[</span>
            <span class="n">shuffled_order</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="TrainingDataSets.make_training_data"><a class="viewcode-back" href="../api/ucf.TrainingDataSets.html#ucf.TrainingDataSets.make_training_data">[docs]</a>    <span class="k">def</span> <span class="nf">make_training_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_size</span><span class="p">,</span> <span class="n">validation_size</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make features and targets</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        train_size : int</span>
<span class="sd">            Proportion of the training set.</span>
<span class="sd">        validation_size: int</span>
<span class="sd">            Proportion of the validation set.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Size of the testing set is determined implicitly.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">validation_end</span> <span class="o">=</span> <span class="n">train_size</span> <span class="o">+</span> <span class="n">validation_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_data</span><span class="p">[</span>
            <span class="mi">0</span><span class="p">:</span><span class="n">train_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_of_features</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_data</span><span class="p">[</span>
            <span class="mi">0</span><span class="p">:</span><span class="n">train_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_of_targets</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validation_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_data</span><span class="p">[</span>
            <span class="n">train_size</span><span class="p">:</span><span class="n">validation_end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_of_features</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validation_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_data</span><span class="p">[</span>
            <span class="n">train_size</span><span class="p">:</span><span class="n">validation_end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_of_targets</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_data</span><span class="p">[</span>
            <span class="n">validation_end</span><span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_of_features</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_data</span><span class="p">[</span>
            <span class="n">validation_end</span><span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_of_targets</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="TrainingDataSets.compute_mean_and_standard_deviation"><a class="viewcode-back" href="../api/ucf.TrainingDataSets.html#ucf.TrainingDataSets.compute_mean_and_standard_deviation">[docs]</a>    <span class="k">def</span> <span class="nf">compute_mean_and_standard_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computation of mean and standard deviation of features</span>
<span class="sd">        in the training data set.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            No explicit return.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Values are stored in the &#39;features_mean&#39; and</span>
<span class="sd">        &#39;features_standard_deviation&#39; attribute of the class.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train_features</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features_standard_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train_features</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="TrainingDataSets.scale_features"><a class="viewcode-back" href="../api/ucf.TrainingDataSets.html#ucf.TrainingDataSets.scale_features">[docs]</a>    <span class="k">def</span> <span class="nf">scale_features</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Standardize features in such manner that their mean is centered</span>
<span class="sd">        to zero, and unit of measurement is set to variance.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.array</span>
<span class="sd">            Standardized features are placed inside appropriate</span>
<span class="sd">            attributes of the class.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_train_features</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train_features</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">features_mean</span>
        <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">features_standard_deviation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_validation_features</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validation_features</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">features_mean</span>
        <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">features_standard_deviation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_test_features</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_features</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">features_mean</span>
        <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">features_standard_deviation</span></div>

<div class="viewcode-block" id="TrainingDataSets.get_scaled_features"><a class="viewcode-back" href="../api/ucf.TrainingDataSets.html#ucf.TrainingDataSets.get_scaled_features">[docs]</a>    <span class="k">def</span> <span class="nf">get_scaled_features</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to return scaled features.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        scaled_train_features : numpy.array</span>
<span class="sd">            Scaled features for training.</span>
<span class="sd">        scaled_validation_features : numpy.array</span>
<span class="sd">            Scaled features for validation.</span>
<span class="sd">        scaled_test_features : numpy.array</span>
<span class="sd">            Scaled features for testing.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scaled_train_features</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scaled_validation_features</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scaled_test_features</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="TrainingDataSets.get_targets"><a class="viewcode-back" href="../api/ucf.TrainingDataSets.html#ucf.TrainingDataSets.get_targets">[docs]</a>    <span class="k">def</span> <span class="nf">get_targets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to return targets and features</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        train_targets : numpy.array</span>
<span class="sd">            Targets for training.</span>
<span class="sd">        validation_targets : numpy.array</span>
<span class="sd">            Targets for validation.</span>
<span class="sd">        test_targets : numpy.array</span>
<span class="sd">            Targets for testing.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train_targets</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validation_targets</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_targets</span>
        <span class="p">)</span></div></div>


<div class="viewcode-block" id="reduce_set_to_equal_distribution_of_classes"><a class="viewcode-back" href="../api/ucf.reduce_set_to_equal_distribution_of_classes.html#ucf.reduce_set_to_equal_distribution_of_classes">[docs]</a><span class="k">def</span> <span class="nf">reduce_set_to_equal_distribution_of_classes</span><span class="p">(</span><span class="n">features_for_training</span><span class="p">,</span>
                                                <span class="n">targets_for_training</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reduces the training set to the size N = K x size of the</span>
<span class="sd">    least frequent class</span>

<span class="sd">    Firstly, the count of least frequent class is computed. Than a pair</span>
<span class="sd">    with features and targets is constructed consisting of samples of</span>
<span class="sd">    all classes. Therefore, generated pair is balanced in regards to</span>
<span class="sd">    distribution of classes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    features_for_training : numpy.array</span>
<span class="sd">        Features which will be used for generating reduced sets.</span>
<span class="sd">    targets_for_training : numpy.array</span>
<span class="sd">        Targets which will be used for generating reduced sets.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy.array  :</span>
<span class="sd">        Two separate numpy.arrays Features and targets reduced to the size of</span>
<span class="sd">        equal to the number of samples belonging to the leas frequent class.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Compute count of all classes.</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">targets_for_training</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
    <span class="c1"># Get the smallest class.</span>
    <span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">count</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">count</span><span class="p">)]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="c1"># Declare lists to store new samples.</span>
    <span class="n">inventory_of_features</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">inventory_of_targets</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">targets_for_training</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)):</span>
        <span class="n">subset_features</span> <span class="o">=</span> \
            <span class="n">features_for_training</span><span class="p">[</span>
                <span class="p">[</span><span class="n">item</span> <span class="o">==</span> <span class="n">label</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">targets_for_training</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="n">subset_features</span> <span class="o">=</span> <span class="n">subset_features</span><span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subset_features</span><span class="p">))</span>
        <span class="p">]</span>
        <span class="n">inventory_of_features</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">subset_features</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">size</span><span class="p">,</span> <span class="p">]])</span>

        <span class="n">inventory_of_targets</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">label</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">),</span> <span class="n">newshape</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="p">])</span>
    <span class="c1"># Return after v-stacking.</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">inventory_of_features</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">inventory_of_targets</span><span class="p">)</span></div>


<div class="viewcode-block" id="generate_ensemble"><a class="viewcode-back" href="../api/ucf.generate_ensemble.html#ucf.generate_ensemble">[docs]</a><span class="k">def</span> <span class="nf">generate_ensemble</span><span class="p">(</span><span class="n">number_of_estimators</span><span class="p">,</span>
                      <span class="n">features_for_training</span><span class="p">,</span>
                      <span class="n">targets_for_training</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a collection of estimators</span>

<span class="sd">    Each estimator is trained on a sub-set of the training data, and</span>
<span class="sd">    appended to the ensemble. Support Vector Classifier has been</span>
<span class="sd">    selected as the classifier of choice, but can be replaced with any</span>
<span class="sd">    other classifier.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    number_of_estimators : int</span>
<span class="sd">        How much estimators will be in the ensemble.</span>
<span class="sd">    features_for_training : numpy.array</span>
<span class="sd">        Features which will be utilized for training of individual</span>
<span class="sd">        estimators.</span>
<span class="sd">    targets_for_training : numpy.array</span>
<span class="sd">        Targets which will be utilized for training of individual</span>
<span class="sd">        estimators.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List</span>
<span class="sd">        A collection of SVCs trained on different sections of features</span>
<span class="sd">        and targets pairs.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The function does not shuffle the data. If shuffling is necessary,</span>
<span class="sd">    it has to be done before call to the function.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">size_of_validation_set</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">features_for_training</span><span class="p">)</span>
        <span class="o">/</span> <span class="n">number_of_estimators</span>
    <span class="p">)</span>
    <span class="c1"># Declare start indices.</span>
    <span class="n">start_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="nb">range</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">features_for_training</span><span class="p">),</span>
            <span class="n">size_of_validation_set</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="c1"># Declare end indices.</span>
    <span class="n">end_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="nb">range</span><span class="p">(</span>
            <span class="n">size_of_validation_set</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">features_for_training</span><span class="p">),</span>
            <span class="n">size_of_validation_set</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Pop last element of start indices list.</span>
    <span class="n">start_indices</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Iterate over start-end indices pairs, subset data, and store</span>
    <span class="c1"># trained model into an inventory.</span>
    <span class="n">inventory_of_models</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">indices</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">start_indices</span><span class="p">,</span> <span class="n">end_indices</span><span class="p">):</span>
        <span class="n">cv_training_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
            <span class="n">features_for_training</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">cv_training_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
            <span class="n">targets_for_training</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">cv_estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span>
            <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span>
            <span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">inventory_of_models</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="n">cv_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
                <span class="n">X</span><span class="o">=</span><span class="n">cv_training_features</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">cv_training_targets</span>
            <span class="p">)</span>
        <span class="p">])</span>
    <span class="k">return</span> <span class="n">inventory_of_models</span></div>


<div class="viewcode-block" id="compute_predictive_entropy"><a class="viewcode-back" href="../api/ucf.compute_predictive_entropy.html#ucf.compute_predictive_entropy">[docs]</a><span class="k">def</span> <span class="nf">compute_predictive_entropy</span><span class="p">(</span><span class="n">probability</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimate epistemic uncertainty via predictive entropy [1]_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    probability : numpy.array</span>
<span class="sd">        A numpy.array (N x C) with the probabilities obtained from the</span>
<span class="sd">        underlying classier (soft voting).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy.array</span>
<span class="sd">        Uncertainty estimate for each prediction.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    For the computation of uncertainty value equal to zero are</span>
<span class="sd">    replaced with a small constant near zero.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Further details about about predictive entropy available at:</span>
<span class="sd">        `https://en.wikipedia.org/wiki/Entropy_(information_theory)`</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">probability</span><span class="p">)</span> <span class="o">*</span> <span class="n">probability</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>


<div class="viewcode-block" id="generate_predictions"><a class="viewcode-back" href="../api/ucf.generate_predictions.html#ucf.generate_predictions">[docs]</a><span class="k">def</span> <span class="nf">generate_predictions</span><span class="p">(</span><span class="n">inventory_of_estimators</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate predictions from ensemble</span>

<span class="sd">    The function applies &#39;predict_proba&#39; method to a collection</span>
<span class="sd">    of estimators, in order to get predictions and compute uncertainty</span>
<span class="sd">    estimate via predictive entropy.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    inventory_of_estimators : list</span>
<span class="sd">        A collection of estimators placed in a list.</span>
<span class="sd">    features : numpy.array</span>
<span class="sd">        Features on which to perform prediction.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ensemble_predictions : numpy.array</span>
<span class="sd">        Prediction of class membership.</span>
<span class="sd">    uncertainty_estimate : numpy.array</span>
<span class="sd">        Uncertainty estimate.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate predictions.</span>
    <span class="n">inventory_of_probabilities</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ensemble</span> <span class="ow">in</span> <span class="n">inventory_of_estimators</span><span class="p">:</span>
        <span class="n">inventory_of_probabilities</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span><span class="n">ensemble</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">features</span><span class="p">)]</span>
        <span class="p">)</span>
    <span class="c1"># Reshape probabilities.</span>
    <span class="n">table_of_probabilities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inventory_of_probabilities</span><span class="p">)</span>
    <span class="c1"># Compute mean of probabilities.</span>
    <span class="n">mean_probabilities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">table_of_probabilities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># Replace zero probabilities wh. numerical constant for stability.</span>
    <span class="n">adjusted_probabilities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">mean_probabilities</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
        <span class="mf">1e-9</span><span class="p">,</span>
        <span class="n">mean_probabilities</span>
    <span class="p">)</span>
    <span class="c1"># Get predictions.</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">adjusted_probabilities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Get uncertainty estimates.</span>
    <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span>
        <span class="n">compute_predictive_entropy</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">arr</span><span class="o">=</span><span class="n">adjusted_probabilities</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">uncertainty</span></div>


<div class="viewcode-block" id="scatter_plot_with_groups"><a class="viewcode-back" href="../api/ucf.scatter_plot_with_groups.html#ucf.scatter_plot_with_groups">[docs]</a><span class="k">def</span> <span class="nf">scatter_plot_with_groups</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span>
                             <span class="n">labels</span><span class="p">,</span>
                             <span class="n">legend_colors</span><span class="p">,</span>
                             <span class="n">legend_descriptions</span><span class="p">,</span>
                             <span class="n">save_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produce scatter plot with coloration according to the labels</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coordinates : numpy.array</span>
<span class="sd">        Coordinates of points.</span>
<span class="sd">    labels : numpy.array</span>
<span class="sd">        Vector indicating class membership of each point.</span>
<span class="sd">    legend_colors : dict</span>
<span class="sd">        Colors to be utilized for coloration of points.</span>
<span class="sd">    legend_descriptions : dict</span>
<span class="sd">        Labels to be utilized for description in plot legend.</span>
<span class="sd">    save_plot : bool</span>
<span class="sd">        Indication whether to save a plot. Defaults to none</span>
<span class="sd">    path : str</span>
<span class="sd">        Path including the file name where to save the plot.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">        No explicit return.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Set figure size.</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Times New Roman&#39;</span>
    <span class="c1"># Set font family.</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">26.6667</span><span class="o">*.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="o">*.</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">figure</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">label</span> <span class="o">==</span> <span class="n">labels</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">legend_colors</span><span class="p">[</span><span class="n">label</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="n">legend_descriptions</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">save_plot</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">buffered_image</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffered_image</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buffered_image</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="make_confusion_matrix"><a class="viewcode-back" href="../api/ucf.make_confusion_matrix.html#ucf.make_confusion_matrix">[docs]</a><span class="k">def</span> <span class="nf">make_confusion_matrix</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">prediction_labels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute confusion matrix</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    reference : numpy.array</span>
<span class="sd">        A vector with reference.</span>
<span class="sd">    output : numpy.array</span>
<span class="sd">        A vector with targets.</span>
<span class="sd">    prediction_labels : list</span>
<span class="sd">        Descriptions of labels.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Confusion matrix as the pandas.DataFrame.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Reference group is placed in row. Proportion of each prediction</span>
<span class="sd">    within the reference group is computed across columns (horizontally).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Counts.</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">reference</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)))</span>
    <span class="n">leading_column_labels</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">label</span> <span class="o">+</span> <span class="s1">&#39; (n=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="n">index</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prediction_labels</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Confusion matrix.</span>
    <span class="n">confusion_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="n">reference</span><span class="p">,</span>
        <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">leading_column</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
        <span class="p">([</span><span class="s1">&#39;Reference&#39;</span><span class="p">],</span> <span class="n">leading_column_labels</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">numeric_columns_with_headings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span>
        <span class="n">prediction_labels</span><span class="p">,</span>
        <span class="p">(</span><span class="n">confusion_matrix</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
        <span class="p">(</span><span class="n">leading_column</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">numeric_columns_with_headings</span><span class="p">)</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="plot_confusion_matrix"><a class="viewcode-back" href="../api/ucf.plot_confusion_matrix.html#ucf.plot_confusion_matrix">[docs]</a><span class="k">def</span> <span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">save_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot confusion matrix</span>

<span class="sd">    Confusion matrix will always be tabulated and plotted. Optionally,</span>
<span class="sd">    picture of confusion matrix can be saved.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    content : numpy.array</span>
<span class="sd">        Numpy array with the complete content of the confusion matrix.</span>
<span class="sd">    save_plot : bool</span>
<span class="sd">        Indication whether to save the plot. Default set to false.</span>
<span class="sd">    path : str</span>
<span class="sd">        Path including the file name where to save the plot.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">        No explicit return. Optionally plot can be saved.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Content must consist all numeric content, as well as headings of</span>
<span class="sd">    all rows and columns.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Set sans-serif font.</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Times New Roman&#39;</span>
    <span class="c1"># Set font family.</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>
    <span class="n">figure</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="c1"># Drop axis.</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="c1"># Declare a table object.</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">table</span><span class="p">(</span>
        <span class="n">cellText</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
        <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
        <span class="n">rasterized</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="c1"># Set properties of cells.</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">_cells</span><span class="p">:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">_cells</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span><span class="o">.</span><span class="n">set_text_props</span><span class="p">(</span><span class="n">linespacing</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">_cells</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span><span class="o">.</span><span class="n">set_height</span><span class="p">(</span><span class="o">.</span><span class="mi">066</span><span class="p">)</span>
        <span class="c1"># Set alignment of leading rows and columns.</span>
        <span class="k">if</span> <span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">table</span><span class="o">.</span><span class="n">_cells</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span><span class="o">.</span><span class="n">_loc</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">cell</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">table</span><span class="o">.</span><span class="n">_cells</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span><span class="o">.</span><span class="n">_loc</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>
    <span class="c1"># Set font size.</span>
    <span class="n">table</span><span class="o">.</span><span class="n">auto_set_font_size</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Utilize maximal space.</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">01</span><span class="p">,</span> <span class="o">.</span><span class="mi">01</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">save_plot</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">buffered_image</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffered_image</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buffered_image</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="plot_solution"><a class="viewcode-back" href="../api/ucf.plot_solution.html#ucf.plot_solution">[docs]</a><span class="k">def</span> <span class="nf">plot_solution</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span>
                  <span class="n">original_labels</span><span class="p">,</span>
                  <span class="n">predicted_labels</span><span class="p">,</span>
                  <span class="n">legend_colors</span><span class="p">,</span>
                  <span class="n">legend_descriptions</span><span class="p">,</span>
                  <span class="n">uncertainty</span><span class="p">,</span>
                  <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plotting of solution of classification task</span>

<span class="sd">    Convenience function to plot: (a) original labels, (b) predicted</span>
<span class="sd">    labels, and (c) uncertainty estimate of the model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coordinates : numpy.array</span>
<span class="sd">        Coordinates of labels</span>
<span class="sd">    original_labels : numpy.array</span>
<span class="sd">        Reference one-dimensional encoding of the class membership.</span>
<span class="sd">        One-hot encoding is not supported.</span>
<span class="sd">    predicted_labels : numpy.array</span>
<span class="sd">        Predicted one-dimensional encoding of the class membership.</span>
<span class="sd">        One-hot encoding is not supported.</span>
<span class="sd">    legend_colors : dict</span>
<span class="sd">        Colors to be utilized for coloration of points.</span>
<span class="sd">    legend_descriptions : dict</span>
<span class="sd">        Labels to be utilized for description in plot legend.</span>
<span class="sd">    uncertainty : numpy.array</span>
<span class="sd">        Uncertainty of the models estimate of class membership.</span>
<span class="sd">    save : bool</span>
<span class="sd">        Option to save the plot. Default set to false.</span>
<span class="sd">    path : str</span>
<span class="sd">        Absolute path to the file in which to save a plot.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">        No explicit return. Plot is displayed on the screen, or saved</span>
<span class="sd">        into a file.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Times New Roman&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">26.6667</span><span class="o">*.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="o">*.</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">grid_spec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="c1"># Plot reference classification.</span>
    <span class="n">axis_1</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">original_labels</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">label</span> <span class="o">==</span> <span class="n">original_labels</span>
        <span class="n">axis_1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">legend_colors</span><span class="p">[</span><span class="n">label</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="n">legend_descriptions</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="n">axis_1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axis_1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Reference&#39;</span><span class="p">)</span>
    <span class="c1"># Plot model solution.</span>
    <span class="n">axis_2</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">predicted_labels</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">label</span> <span class="o">==</span> <span class="n">predicted_labels</span>
        <span class="n">axis_2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">legend_colors</span><span class="p">[</span><span class="n">label</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="n">legend_descriptions</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="n">axis_2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span>
    <span class="c1"># Uncertainty estimate.</span>
    <span class="n">axis_3</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">axis_3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">c</span><span class="o">=</span><span class="n">uncertainty</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn_r&#39;</span>
    <span class="p">)</span>
    <span class="n">axis_3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Uncertainty Estimate&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">save</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">buffered_image</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffered_image</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buffered_image</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="plot_comparison"><a class="viewcode-back" href="../api/ucf.plot_comparison.html#ucf.plot_comparison">[docs]</a><span class="k">def</span> <span class="nf">plot_comparison</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span>
                    <span class="n">reference</span><span class="p">,</span>
                    <span class="n">solutions</span><span class="p">,</span>
                    <span class="n">description</span><span class="p">,</span>
                    <span class="n">coloration</span><span class="p">,</span>
                    <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot comparison across different classification solutions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coordinates : numpy.array</span>
<span class="sd">        Coordinates of the points.</span>
<span class="sd">    reference : numpy.array</span>
<span class="sd">        Labels of the reference.</span>
<span class="sd">    solutions : list</span>
<span class="sd">        List containing solutions of classification problem.</span>
<span class="sd">    description : dict</span>
<span class="sd">        Description of each label.</span>
<span class="sd">    coloration : dict</span>
<span class="sd">        Vector with coloration.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">        No explicit return. Plot is displayed on the screen, or saved</span>
<span class="sd">        into a file.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Times New Roman&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">26.6667</span><span class="o">*.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="o">*.</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">grid_spec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">solutions</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Plot reference classification.</span>
    <span class="n">axis_1</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">label</span> <span class="o">==</span> <span class="n">reference</span>
        <span class="n">axis_1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">coloration</span><span class="p">[</span><span class="n">label</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="n">description</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="n">axis_1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axis_1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Reference&#39;</span><span class="p">)</span>
    <span class="c1"># Plot model solution.</span>
    <span class="k">for</span> <span class="n">solution</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">solutions</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">axis_2</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">solution</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">solutions</span><span class="p">[</span><span class="n">solution</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">label</span> <span class="o">==</span> <span class="n">solutions</span><span class="p">[</span><span class="n">solution</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">axis_2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">coloration</span><span class="p">[</span><span class="n">label</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="n">description</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="n">axis_2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">save</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">buffered_image</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffered_image</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buffered_image</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="plot_individual_classes"><a class="viewcode-back" href="../api/ucf.plot_individual_classes.html#ucf.plot_individual_classes">[docs]</a><span class="k">def</span> <span class="nf">plot_individual_classes</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span>
                            <span class="n">class_membership</span><span class="p">,</span>
                            <span class="n">description</span><span class="p">,</span>
                            <span class="n">coloration_mode</span><span class="p">,</span>
                            <span class="n">coloration</span><span class="p">,</span>
                            <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot class membership in individual plot</span>

<span class="sd">    Point within scatter plots indicating class membership with multiple</span>
<span class="sd">    classes can often overlap, therefore debilitating correct analysis. This</span>
<span class="sd">    function plots all classes independently.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coordinates : numpy.array</span>
<span class="sd">        Coordinates of points.</span>
<span class="sd">    class_membership : numpy.array</span>
<span class="sd">        Indication of class membership.</span>
<span class="sd">    description : dict</span>
<span class="sd">        Description of each label.</span>
<span class="sd">    coloration_mode : str</span>
<span class="sd">        Indication of the mode of coloration.</span>
<span class="sd">    coloration : numpy.array</span>
<span class="sd">        Vector with coloration.</span>
<span class="sd">    save : bool</span>
<span class="sd">        Option to save the plot.</span>
<span class="sd">    path : str</span>
<span class="sd">        Absolute path towards the file in which to save the plot.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">        No explicit return.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">number_of_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">class_membership</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Times New Roman&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">26.6667</span><span class="o">*.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="o">*.</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">position</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span>
        <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">number_of_classes</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span>
        <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">number_of_classes</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
    <span class="p">))</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">grid_spec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">number_of_classes</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">number_of_classes</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">label</span> <span class="o">==</span> <span class="n">class_membership</span>
        <span class="k">if</span> <span class="n">coloration_mode</span> <span class="o">==</span> <span class="s1">&#39;discrete&#39;</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">position</span><span class="p">[</span><span class="n">label</span><span class="p">]])</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">c</span><span class="o">=</span><span class="n">coloration</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">coloration_mode</span> <span class="o">==</span> <span class="s1">&#39;continuous&#39;</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">position</span><span class="p">[</span><span class="n">label</span><span class="p">]])</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">coordinates</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">c</span><span class="o">=</span><span class="n">coloration</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span>
                <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn&#39;</span>
            <span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">1.2</span>
        <span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mf">1.2</span>
        <span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Class: &#39;</span><span class="o">+</span><span class="n">description</span><span class="p">[</span><span class="n">label</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">save</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">buffered_image</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffered_image</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buffered_image</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span></div>


<span class="c1"># if __name__ == &#39;__main__&#39;:</span>

    <span class="c1"># # Declare file handles.</span>
    <span class="c1"># DATA_FILE_FOLDER = r&#39;M:\Projects\010_classification\1_data&#39;</span>

    <span class="c1"># # Concatenate data sets.</span>
    <span class="c1"># concatenated_data_set = pd.concat(</span>
        <span class="c1"># get_data(folder_wh_data=DATA_FILE_FOLDER),</span>
        <span class="c1"># axis=0</span>
    <span class="c1"># )</span>

    <span class="c1"># attribute_name = [</span>
        <span class="c1"># &#39;acceleration_frontal_axis_g&#39;,</span>
        <span class="c1"># &#39;acceleration_vertical_axis_g&#39;,</span>
        <span class="c1"># &#39;acceleration_lateral_axis_g&#39;,</span>
        <span class="c1"># &#39;id_antenna_reading_sensor_g&#39;,</span>
        <span class="c1"># &#39;signal_strength_indicator_g&#39;,</span>
        <span class="c1"># &#39;phase&#39;,</span>
        <span class="c1"># &#39;frequency&#39;,</span>
        <span class="c1"># &#39;activity&#39;</span>
    <span class="c1"># ]</span>

    <span class="c1"># concatenated_data_set.columns = attribute_name</span>

    <span class="c1"># # Recoding.</span>
    <span class="c1"># recoded_targets = np.argmax(np.vstack((</span>
        <span class="c1"># np.where(concatenated_data_set[&#39;activity&#39;] == 1, 1, 0),</span>
        <span class="c1"># np.where(concatenated_data_set[&#39;activity&#39;] == 2, 1, 0),</span>
        <span class="c1"># np.where(concatenated_data_set[&#39;activity&#39;] == 3, 1, 0),</span>
        <span class="c1"># np.where(concatenated_data_set[&#39;activity&#39;] == 4, 1, 0)</span>
    <span class="c1"># )), axis=0)</span>

    <span class="c1"># # Replace original wh. recoded.</span>
    <span class="c1"># concatenated_data_set[&#39;activity&#39;] = recoded_targets</span>

    <span class="c1"># # Label of activity, 0: sit on bed, 1: sit on chair, 2: lying,</span>
    <span class="c1"># # 3: ambulating</span>

    <span class="c1"># # Instantiate a class TrainingDataSets.</span>
    <span class="c1"># training_data_sets = TrainingDataSets(</span>
        <span class="c1"># features_and_targets_data_set=concatenated_data_set.values</span>
    <span class="c1"># )</span>

    <span class="c1"># # Set indices of features.</span>
    <span class="c1"># training_data_sets.indices_of_features = list(range(3))</span>

    <span class="c1"># # Set indices of targets.</span>
    <span class="c1"># training_data_sets.indices_of_targets = 7</span>

    <span class="c1"># # Make training, validation and testing data sets.</span>
    <span class="c1"># training_data_sets.make_training_data(</span>
        <span class="c1"># train_size=int(len(concatenated_data_set)*.75),</span>
        <span class="c1"># validation_size=int(len(concatenated_data_set)*.05)</span>
    <span class="c1"># )</span>

    <span class="c1"># # Compute mean and standard deviation.</span>
    <span class="c1"># training_data_sets.compute_mean_and_standard_deviation()</span>

    <span class="c1"># # Scale features.</span>
    <span class="c1"># training_data_sets.scale_features()</span>

    <span class="c1"># # Shuffle scaled features and targets.</span>
    <span class="c1"># training_data_sets.shuffle()</span>

    <span class="c1"># # Get scaled features.</span>
    <span class="c1"># x_train, x_validation, x_test = \</span>
        <span class="c1"># training_data_sets.get_scaled_features()</span>

    <span class="c1"># # Suppress scientific notation.</span>
    <span class="c1"># np.set_printoptions(suppress=True)</span>
    <span class="c1"># print(np.var(x_train, axis=0))</span>

    <span class="c1"># # Get targets.</span>
    <span class="c1"># y_train, y_validation, y_test = \</span>
        <span class="c1"># training_data_sets.get_targets()</span>

    <span class="c1"># # Latent factor analysis.</span>
    <span class="c1"># latent_factor = PCA(n_components=2)</span>
    <span class="c1"># latent_factor.fit(X=x_train)</span>
    <span class="c1"># projection = latent_factor.transform(X=x_train)</span>

    <span class="c1"># # Frequency of classes.</span>
    <span class="c1"># class_proportion_train = (np.bincount(</span>
        <span class="c1"># y_train.astype(int)</span>
    <span class="c1"># )/len(y_train)*100).astype(int)</span>

    <span class="c1"># # Plot class membership.</span>
    <span class="c1"># scatter_plot_with_groups(</span>
        <span class="c1"># coordinates=projection,</span>
        <span class="c1"># labels=y_train,</span>
        <span class="c1"># legend_colors={</span>
            <span class="c1"># 0: &#39;blue&#39;,</span>
            <span class="c1"># 1: &#39;orange&#39;,</span>
            <span class="c1"># 2: &#39;green&#39;,</span>
            <span class="c1"># 3: &#39;red&#39;</span>
        <span class="c1"># },</span>
        <span class="c1"># legend_descriptions={</span>
            <span class="c1"># 0: &#39;Sitting on bed: &#39;+str(class_proportion_train[0])+&#39;%&#39;,</span>
            <span class="c1"># 1: &#39;Sitting on chair: &#39;+str(class_proportion_train[1])+&#39;%&#39;,</span>
            <span class="c1"># 2: &#39;Lying: &#39;+str(class_proportion_train[2])+&#39;%&#39;,</span>
            <span class="c1"># 3: &#39;Ambulating: &#39;+str(class_proportion_train[3])+&#39;%&#39;</span>
        <span class="c1"># }</span>
    <span class="c1"># )</span>

    <span class="c1"># # Plot individual classes.</span>
    <span class="c1"># plot_individual_classes(</span>
        <span class="c1"># coordinates=projection,</span>
        <span class="c1"># class_membership=y_train,</span>
        <span class="c1"># description={</span>
            <span class="c1"># 0: &#39;Sitting on bed: &#39;+str(class_proportion_train[0])+&#39;%&#39;,</span>
            <span class="c1"># 1: &#39;Sitting on chair: &#39;+str(class_proportion_train[1])+&#39;%&#39;,</span>
            <span class="c1"># 2: &#39;Lying: &#39;+str(class_proportion_train[2])+&#39;%&#39;,</span>
            <span class="c1"># 3: &#39;Ambulating: &#39;+str(class_proportion_train[3])+&#39;%&#39;</span>
        <span class="c1"># },</span>
        <span class="c1"># coloration_mode=&#39;discrete&#39;,</span>
        <span class="c1"># coloration={</span>
            <span class="c1"># 0: &#39;blue&#39;,</span>
            <span class="c1"># 1: &#39;orange&#39;,</span>
            <span class="c1"># 2: &#39;green&#39;,</span>
            <span class="c1"># 3: &#39;red&#39;</span>
        <span class="c1"># }</span>
    <span class="c1"># )</span>

    <span class="c1"># # Fit a SVM.</span>
    <span class="c1"># estimator = SVC(</span>
        <span class="c1"># C=1,</span>
        <span class="c1"># kernel=&#39;rbf&#39;,</span>
        <span class="c1"># probability=True,</span>
        <span class="c1"># random_state=np.random.seed(0)</span>
    <span class="c1"># )</span>
    <span class="c1"># estimator.fit(X=x_train, y=y_train)</span>

    <span class="c1"># # Generate predictions.</span>
    <span class="c1"># predictions = estimator.predict(X=x_test)</span>

    <span class="c1"># # Get estimators uncertainty estimate.</span>
    <span class="c1"># uncertainty_estimate = estimator.predict_proba(X=x_test)</span>
    <span class="c1"># uncertainty_estimate_per_class = uncertainty_estimate[</span>
        <span class="c1"># list(range(0, len(uncertainty_estimate))),</span>
        <span class="c1"># [int(column) for column in predictions]</span>
    <span class="c1"># ]</span>

    <span class="c1"># # Compute accuracy.</span>
    <span class="c1"># accuracy = estimator.score(X=x_test, y=y_test)</span>
    <span class="c1"># print(&#39;Estimator accuracy: %s percent.&#39; % int(accuracy*100))</span>

    <span class="c1"># # Frequency of classes.</span>
    <span class="c1"># class_proportion_test = (np.bincount(</span>
        <span class="c1"># y_test.astype(int)</span>
    <span class="c1"># ) / len(y_test) * 100).astype(int)</span>

    <span class="c1"># # Plot decision boundary.</span>
    <span class="c1"># plot_solution(</span>
        <span class="c1"># coordinates=latent_factor.transform(x_test),</span>
        <span class="c1"># original_labels=y_test,</span>
        <span class="c1"># predicted_labels=predictions,</span>
        <span class="c1"># legend_colors={</span>
            <span class="c1"># 0: &#39;blue&#39;,</span>
            <span class="c1"># 1: &#39;orange&#39;,</span>
            <span class="c1"># 2: &#39;green&#39;,</span>
            <span class="c1"># 3: &#39;red&#39;</span>
        <span class="c1"># },</span>
        <span class="c1"># legend_descriptions={</span>
            <span class="c1"># 0: &#39;Sit. bed: &#39;+str(class_proportion_test[0])+&#39;%&#39;,</span>
            <span class="c1"># 1: &#39;Sit. chair: &#39;+str(class_proportion_test[1])+&#39;%&#39;,</span>
            <span class="c1"># 2: &#39;Lay.: &#39;+str(class_proportion_test[2])+&#39;%&#39;,</span>
            <span class="c1"># 3: &#39;Amb.: &#39;+str(class_proportion_test[3])+&#39;%&#39;</span>
        <span class="c1"># },</span>
        <span class="c1"># uncertainty=1-uncertainty_estimate_per_class</span>
    <span class="c1"># )</span>

    <span class="c1"># # Make confusion matrix.</span>
    <span class="c1"># table_with_confusion_matrix = make_confusion_matrix(</span>
        <span class="c1"># reference=y_test,</span>
        <span class="c1"># output=predictions,</span>
        <span class="c1"># prediction_labels=[</span>
            <span class="c1"># &#39;Sitting on bed&#39;,</span>
            <span class="c1"># &#39;Sitting on chair&#39;,</span>
            <span class="c1"># &#39;Lying&#39;,</span>
            <span class="c1"># &#39;Ambulating&#39;</span>
        <span class="c1"># ]</span>
    <span class="c1"># )</span>

    <span class="c1"># # Plot confusion matrix.</span>
    <span class="c1"># plot_confusion_matrix(content=table_with_confusion_matrix)</span>

    <span class="c1"># # Generate balanced set.</span>
    <span class="c1"># balanced_x_train, balanced_y_train = \</span>
        <span class="c1"># reduce_set_to_equal_distribution_of_classes(</span>
            <span class="c1"># features_for_training=x_train,</span>
            <span class="c1"># targets_for_training=y_train</span>
        <span class="c1"># )</span>

    <span class="c1"># # Fit ensemble.</span>
    <span class="c1"># ensembles = generate_ensemble(</span>
        <span class="c1"># number_of_estimators=30,</span>
        <span class="c1"># features_for_training=balanced_x_train,</span>
        <span class="c1"># targets_for_training=balanced_y_train</span>
    <span class="c1"># )</span>

    <span class="c1"># # Get ensemble predictions.</span>
    <span class="c1"># ensemble_predictions, ensemble_uncertainty = generate_predictions(</span>
        <span class="c1"># inventory_of_estimators=ensembles,</span>
        <span class="c1"># features=x_test</span>
    <span class="c1"># )</span>

    <span class="c1"># # Compute ensemble accuracy.</span>
    <span class="c1"># ensemble_accuracy = (</span>
        <span class="c1"># np.sum((y_test.astype(int) == ensemble_predictions).astype(int))</span>
        <span class="c1"># / len(ensemble_predictions)</span>
    <span class="c1"># )</span>
    <span class="c1"># print(ensemble_accuracy)</span>

    <span class="c1"># # Make confusion matrix.</span>
    <span class="c1"># table_with_ensemble_confusion_matrix = make_confusion_matrix(</span>
        <span class="c1"># reference=y_test,</span>
        <span class="c1"># output=ensemble_predictions,</span>
        <span class="c1"># prediction_labels=[</span>
            <span class="c1"># &#39;Sitting on bed&#39;,</span>
            <span class="c1"># &#39;Sitting on chair&#39;,</span>
            <span class="c1"># &#39;Lying&#39;,</span>
            <span class="c1"># &#39;Ambulating&#39;</span>
        <span class="c1"># ]</span>
    <span class="c1"># )</span>

    <span class="c1"># # Plot confusion matrix.</span>
    <span class="c1"># plot_confusion_matrix(</span>
        <span class="c1"># content=table_with_ensemble_confusion_matrix</span>
    <span class="c1"># )</span>

    <span class="c1"># # Plot ensemble&#39;s classification solution.</span>
    <span class="c1"># plot_solution(</span>
        <span class="c1"># coordinates=latent_factor.transform(x_test),</span>
        <span class="c1"># original_labels=y_test,</span>
        <span class="c1"># predicted_labels=ensemble_predictions,</span>
        <span class="c1"># legend_colors={</span>
            <span class="c1"># 0: &#39;blue&#39;,</span>
            <span class="c1"># 1: &#39;orange&#39;,</span>
            <span class="c1"># 2: &#39;green&#39;,</span>
            <span class="c1"># 3: &#39;red&#39;</span>
        <span class="c1"># },</span>
        <span class="c1"># legend_descriptions={</span>
            <span class="c1"># 0: &#39;Sit. bed: &#39;+str(class_proportion_test[0])+&#39;%&#39;,</span>
            <span class="c1"># 1: &#39;Sit. chair: &#39;+str(class_proportion_test[1])+&#39;%&#39;,</span>
            <span class="c1"># 2: &#39;Lay.: &#39;+str(class_proportion_test[2])+&#39;%&#39;,</span>
            <span class="c1"># 3: &#39;Amb.: &#39;+str(class_proportion_test[3])+&#39;%&#39;</span>
        <span class="c1"># },</span>
        <span class="c1"># uncertainty=ensemble_uncertainty</span>
    <span class="c1"># )</span>

    <span class="c1"># # Plot comparison between SVC and SVC ensemble.</span>
    <span class="c1"># plot_comparison(</span>
        <span class="c1"># coordinates=latent_factor.transform(X=x_test),</span>
        <span class="c1"># reference=y_test,</span>
        <span class="c1"># solutions=[</span>
            <span class="c1"># predictions, ensemble_predictions</span>
        <span class="c1"># ],</span>
        <span class="c1"># coloration={</span>
            <span class="c1"># 0: &#39;blue&#39;,</span>
            <span class="c1"># 1: &#39;orange&#39;,</span>
            <span class="c1"># 2: &#39;green&#39;,</span>
            <span class="c1"># 3: &#39;red&#39;</span>
        <span class="c1"># },</span>
        <span class="c1"># description={</span>
            <span class="c1"># 0: &#39;Sit. bed: &#39;+str(class_proportion_test[0])+&#39;%&#39;,</span>
            <span class="c1"># 1: &#39;Sit. chair: &#39;+str(class_proportion_test[1])+&#39;%&#39;,</span>
            <span class="c1"># 2: &#39;Lay.: &#39;+str(class_proportion_test[2])+&#39;%&#39;,</span>
            <span class="c1"># 3: &#39;Amb.: &#39;+str(class_proportion_test[3])+&#39;%&#39;</span>
        <span class="c1"># }</span>
    <span class="c1"># )</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Marko Djordjic.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> and   using a custom <a href="https://github.com/LinxiFan/Stanford-theme">theme</a> based on <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>